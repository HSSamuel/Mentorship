import{r as t,c as f,V as x,j as e,L as F}from"./index-DpNFJqVI.js";import{c as R}from"./createLucideIcon-C_DQYBsD.js";import{S as _}from"./search-CKaqelDn.js";import{E as V}from"./eye-vMkwPxwQ.js";import{S as q}from"./square-pen-ab8tmZQE.js";import{T as P}from"./trash-2-WLwEyqkU.js";import{A as H,U as Y}from"./user-Dz8KJV_s.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],G=R("refresh-cw",B);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],K=R("shield",J),T={MENTEE:{icon:e.jsx(Y,{size:14,className:"mr-1.5"}),color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",borderColor:"border-green-500"},MENTOR:{icon:e.jsx(H,{size:14,className:"mr-1.5"}),color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",borderColor:"border-blue-500"},ADMIN:{icon:e.jsx(K,{size:14,className:"mr-1.5"}),color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",borderColor:"border-purple-500"}},Q=({isOpen:d,onClose:l,onConfirm:i,title:o,children:a})=>d?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-md transform transition-all",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:o}),e.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:a}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:i,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 shadow-md hover:shadow-lg transition-all",children:"Confirm"})]})]})}):null,W=({isOpen:d,onClose:l,onSave:i,user:o,selectedRole:a,setSelectedRole:u})=>{const[g,m]=t.useState(!1);if(!d||!o)return null;const n=async()=>{m(!0),await i()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-md transform transition-all",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:["Edit Role for ",o.profile.name]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"role-select",className:"mb-2 font-semibold text-gray-700 dark:text-gray-300",children:"User Role"}),e.jsxs("select",{id:"role-select",value:a,onChange:h=>u(h.target.value),className:"p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"ADMIN",children:"ADMIN"}),e.jsx("option",{value:"MENTOR",children:"MENTOR"}),e.jsx("option",{value:"MENTEE",children:"MENTEE"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:n,disabled:g,className:"flex justify-center items-center w-36 px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 shadow-md transition-all disabled:bg-gray-400 disabled:cursor-not-allowed",children:g?"Saving...":"Save Changes"})]})]})})},le=()=>{const[d,l]=t.useState([]),[i,o]=t.useState([]),[a,u]=t.useState(!0),[g,m]=t.useState(null),[n,h]=t.useState(""),[L,y]=t.useState(!1),[c,j]=t.useState(null),[A,k]=t.useState(!1),[p,N]=t.useState(null),[v,w]=t.useState("MENTEE"),[b,C]=t.useState(!1),E=t.useCallback(async()=>{a?u(!0):C(!0);try{const s=(await f.get("/admin/users?limit=1000")).data.users||[];l(s),o(s),m(null),a||x.success("User list updated!")}catch(r){const s=r.response?.data?.message||"Failed to fetch users.";m(s),x.error(s),console.error(r)}finally{u(!1),C(!1)}},[a]);t.useEffect(()=>{E()},[]),t.useEffect(()=>{const r=d.filter(s=>(s.profile?.name?.toLowerCase()||"n/a").includes(n.toLowerCase())||s.email.toLowerCase().includes(n.toLowerCase())||s.role.toLowerCase().includes(n.toLowerCase()));o(r)},[n,d]);const I=r=>{j(r),y(!0)},M=()=>{j(null),y(!1)},$=async()=>{if(c)try{await f.delete(`/admin/users/${c.id}`),l(r=>r.filter(s=>s.id!==c.id)),x.success("User deleted successfully.")}catch(r){x.error(`Failed to delete user ${c.profile.name}.`),console.error(r)}finally{M()}},z=r=>{N(r),w(r.role),k(!0)},S=()=>{k(!1),N(null)},O=async()=>{if(p)try{const s=(await f.put(`/admin/users/${p.id}/role`,{role:v})).data;l(D=>D.map(U=>U.id===s.id?s:U)),x.success("Role updated successfully."),S()}catch(r){x.error(`Failed to update role for ${p.profile.name}.`),console.error(r)}};return a?e.jsx("div",{className:"p-10 text-center",children:"Loading users..."}):g?e.jsx("div",{className:"p-10 text-center text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-300 rounded-md",children:g}):e.jsx("div",{className:"p-4 md:p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"User Management"}),e.jsxs("button",{onClick:E,disabled:b,className:"flex items-center justify-center gap-2 px-4 py-2 text-sm font-semibold text-indigo-600 bg-indigo-100 rounded-md hover:bg-indigo-200 dark:bg-indigo-900 dark:text-indigo-300 dark:hover:bg-indigo-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(G,{className:`w-4 h-4 ${b?"animate-spin":""}`}),b?"Refreshing...":"Refresh"]})]}),e.jsxs("div",{className:"mb-8 relative",children:[e.jsx(_,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, or role...",className:"w-full p-3 pl-12 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",value:n,onChange:r=>h(r.target.value)})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:i.length>0?i.map(r=>{const s=T[r.role]||T.MENTEE;return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 flex flex-col border-l-4 ${s.borderColor}`,children:[e.jsxs("div",{className:"p-5 flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("img",{src:r.profile?.avatarUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.profile?.name||r.email)}&background=random`,alt:r.profile?.name||r.email,className:"w-14 h-14 rounded-full object-cover border-2 border-gray-200 dark:border-gray-600"}),e.jsxs("div",{className:"flex-grow overflow-hidden",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 dark:text-white truncate",children:r.profile?.name||"N/A"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:r.email})]})]}),e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${s.color}`,children:[s.icon,r.role]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 px-5 py-3 flex justify-end gap-2",children:[e.jsxs(F,{to:`/users/${r.id}`,target:"_blank",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-blue-700 bg-blue-100 rounded-md hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800 transition-colors",children:[e.jsx(V,{size:14})," View"]}),e.jsxs("button",{onClick:()=>z(r),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-purple-700 bg-purple-100 rounded-md hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-300 dark:hover:bg-purple-800 transition-colors",children:[e.jsx(q,{size:14})," Edit"]}),e.jsxs("button",{onClick:()=>I(r),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold text-red-700 bg-red-100 rounded-md hover:bg-red-200 dark:bg-red-900 dark:text-red-300 dark:hover:bg-red-800 transition-colors",children:[e.jsx(P,{size:14})," Delete"]})]})]},r.id)}):e.jsxs("div",{className:"col-span-full text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"No Users Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Your search did not match any users."})]})}),e.jsx(Q,{isOpen:L,onClose:M,onConfirm:$,title:"Confirm User Deletion",children:e.jsxs("p",{children:["Are you sure you want to delete this user:"," ",e.jsx("strong",{children:c?.profile?.name||c?.email}),"? This action cannot be undone."]})}),e.jsx(W,{isOpen:A,onClose:S,onSave:O,user:p,selectedRole:v,setSelectedRole:w})]})})};export{le as default};
