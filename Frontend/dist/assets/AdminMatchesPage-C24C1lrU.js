import{r as a,j as e,c as h,V as x}from"./index-DpNFJqVI.js";import{X as A}from"./x-CUAZlBTh.js";import{S as D}from"./search-CKaqelDn.js";import{U as q,A as I}from"./user-Dz8KJV_s.js";import{c as R}from"./createLucideIcon-C_DQYBsD.js";import{S as T}from"./square-pen-ab8tmZQE.js";import{T as L}from"./trash-2-WLwEyqkU.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],P=R("circle-plus",O),z=()=>e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),$=({isOpen:r,onClose:n,onMatchCreated:l})=>{const[d,i]=a.useState([]),[m,N]=a.useState([]),[p,g]=a.useState(!0),[f,k]=a.useState(""),[o,c]=a.useState(null),[u,b]=a.useState(null),[t,y]=a.useState(""),[w,v]=a.useState(!1);a.useEffect(()=>{r&&(c(null),b(null),y(""),(async()=>{try{g(!0);const[j,E]=await Promise.all([h.get("/admin/users?role=MENTOR&limit=1000"),h.get("/admin/users?role=MENTEE&limit=1000")]);i(j.data.users||[]),N(E.data.users||[])}catch{k("Failed to fetch users."),x.error("Could not load users for assignment.")}finally{g(!1)}})())},[r]);const C=async()=>{if(!o||!u){x.error("Please select both a mentor and a mentee.");return}v(!0);try{await h.post("/admin/matches",{mentorId:o,menteeId:u}),x.success("Mentorship match created successfully!"),l(),n()}catch(s){const j=s.response?.data?.message||"Failed to create match.";x.error(j)}finally{v(!1)}},M=a.useMemo(()=>m.filter(s=>s.profile?.name?.toLowerCase().includes(t.toLowerCase())),[m,t]),S=a.useMemo(()=>d.filter(s=>s.profile?.name?.toLowerCase().includes(t.toLowerCase())),[d,t]);return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-3xl transform transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Create a New Match"}),e.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:e.jsx(A,{size:24})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name...",value:t,onChange:s=>y(s.target.value),className:"w-full pl-10 pr-4 py-2 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-h-80 overflow-y-auto p-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"flex items-center font-semibold mb-2 text-gray-800 dark:text-gray-200",children:[e.jsx(q,{size:16,className:"mr-2 text-green-500"}),"Select a Mentee"]}),e.jsx("div",{className:"border dark:border-gray-600 rounded-lg h-full",children:p?e.jsx("p",{className:"p-4 text-center",children:"Loading..."}):M.map(s=>e.jsxs("div",{onClick:()=>b(s.id),className:`flex items-center p-3 cursor-pointer border-l-4 transition-colors ${u===s.id?"border-green-500 bg-green-50 dark:bg-green-900/50":"border-transparent hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("img",{src:s.profile?.avatarUrl||`https://ui-avatars.com/api/?name=${s.profile?.name}`,alt:s.profile?.name,className:"w-8 h-8 rounded-full mr-3"}),e.jsx("span",{children:s.profile?.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"flex items-center font-semibold mb-2 text-gray-800 dark:text-gray-200",children:[e.jsx(I,{size:16,className:"mr-2 text-blue-500"}),"Select a Mentor"]}),e.jsx("div",{className:"border dark:border-gray-600 rounded-lg h-full",children:p?e.jsx("p",{className:"p-4 text-center",children:"Loading..."}):S.map(s=>e.jsxs("div",{onClick:()=>c(s.id),className:`flex items-center p-3 cursor-pointer border-l-4 transition-colors ${o===s.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/50":"border-transparent hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("img",{src:s.profile?.avatarUrl||`https://ui-avatars.com/api/?name=${s.profile?.name}`,alt:s.profile?.name,className:"w-8 h-8 rounded-full mr-3"}),e.jsx("span",{children:s.profile?.name})]},s.id))})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:C,disabled:!o||!u||w,className:"flex justify-center items-center w-48 px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 shadow-md transition-all disabled:bg-gray-400 disabled:cursor-not-allowed",children:w?e.jsx(z,{}):"Confirm Assignment"})]})]})}):null},F=({status:r})=>{const n="px-3 py-1 text-xs font-medium rounded-full";let l="";switch(r){case"PENDING":l="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200";break;case"ACCEPTED":l="bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200";break;case"REJECTED":l="bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200";break;default:l="bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}return e.jsx("span",{className:`${n} ${l}`,children:r})},U=({modalState:r,onClose:n,onConfirm:l,title:d,children:i})=>r.isOpen?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:d}),e.jsx("div",{children:i}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{onClick:l,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",children:"Confirm"})]})]})}):null,G=({modalState:r,onClose:n,onSave:l})=>{const[d,i]=a.useState(r.match?.status);return r.isOpen?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"Edit Request Status"}),e.jsxs("p",{className:"mb-4 text-gray-600 dark:text-gray-300",children:["Change the status for the request between"," ",e.jsx("strong",{children:r.match.mentor.profile.name})," and"," ",e.jsx("strong",{children:r.match.mentee.profile.name}),"."]}),e.jsxs("select",{value:d,onChange:m=>i(m.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"PENDING",children:"PENDING"}),e.jsx("option",{value:"ACCEPTED",children:"ACCEPTED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{onClick:()=>l(r.match.id,d),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:"Save Changes"})]})]})}):null},K=()=>{const[r,n]=a.useState([]),[l,d]=a.useState(!0),[i,m]=a.useState(""),[N,p]=a.useState(!1),[g,f]=a.useState({isOpen:!1,match:null}),[k,o]=a.useState({isOpen:!1,match:null}),c=a.useCallback(async()=>{d(!0);try{const t=await h.get("/admin/matches");n(t.data)}catch(t){m(t.response?.data?.message||"Failed to fetch matches.")}finally{d(!1)}},[]);a.useEffect(()=>{c()},[c]);const u=async()=>{if(g.match)try{await h.delete(`/admin/requests/${g.match.id}`),x.success("Request deleted successfully."),c()}catch{x.error("Failed to delete request.")}finally{f({isOpen:!1,match:null})}},b=async(t,y)=>{try{await h.put(`/admin/requests/${t}/status`,{status:y}),x.success("Request status updated successfully."),c()}catch{x.error("Failed to update status.")}finally{o({isOpen:!1,match:null})}};return l?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Loading all matches..."}):i?e.jsxs("p",{className:"text-center text-red-500",children:["Error: ",i]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white text-center sm:text-left",children:"All Mentorship Matches"}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 shadow-md hover:shadow-lg transition-all",children:[e.jsx(P,{size:20}),"Create New Match"]})]}),r.length>0?e.jsx("div",{className:"bg-gradient-to-br from-blue-50 via-teal-50 to-cyan-50 dark:from-blue-900/50 dark:via-teal-900/50 dark:to-cyan-900/50 rounded-xl shadow-2xl p-4",children:e.jsx("ul",{className:"space-y-4",children:r.map(t=>e.jsxs("li",{className:"p-6 bg-white/70 dark:bg-gray-800/70 rounded-lg shadow-md flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("p",{className:"font-semibold text-gray-800 dark:text-gray-200",children:[e.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:t.mentor.profile?.name||"N/A"})," ","(Mentor) ↔"," ",e.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:t.mentee.profile?.name||"N/A"})," ","(Mentee)"]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Requested on:"," ",new Date(t.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o({isOpen:!0,match:t}),className:"p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(T,{size:16,className:"text-gray-600 dark:text-gray-300"})}),e.jsx("button",{onClick:()=>f({isOpen:!0,match:t}),className:"p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(L,{size:16,className:"text-red-500"})})]}),e.jsx(F,{status:t.status})]})]},t.id))})}):e.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"No Matches Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"There are no mentorship requests or matches in the system yet."})]}),e.jsx($,{isOpen:N,onClose:()=>p(!1),onMatchCreated:c}),e.jsx(U,{modalState:g,onClose:()=>f({isOpen:!1,match:null}),onConfirm:u,title:"Confirm Deletion",children:e.jsx("p",{children:"Are you sure you want to delete this pending request? This action cannot be undone."})}),e.jsx(G,{modalState:k,onClose:()=>o({isOpen:!1,match:null}),onSave:b})]})};export{K as default};
