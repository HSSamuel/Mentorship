import{h as z,f as O,u as F,r as n,j as e,L as w,c as x,V as k}from"./index-kKR_KBkN.js";import{A as V,U as _}from"./user-D8QAxvOC.js";import{S as B}from"./square-pen-dQS2Ts3H.js";import{M as G}from"./message-square-CbB5hG0X.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],W=z("calendar-plus",H),J=s=>{if(!s)return"N/A";const a=new Date(s),o=Math.round((new Date().getTime()-a.getTime())/(1e3*60)),r=Math.round(o/60),d=Math.round(r/24);return o<1?"Online":o<60?`Last seen ${o} minute${o===1?"":"s"} ago`:r<24?`Last seen ${r} hour${r===1?"":"s"} ago`:d===1?"Last seen yesterday":d<7?`Last seen ${d} day${d===1?"":"s"} ago`:`Last seen ${a.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`},Y=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),R=({rating:s,totalReviews:a})=>{const t=Math.round(s);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((o,r)=>e.jsx("svg",{className:`w-5 h-5 ${r<t?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},r))}),a>0&&e.jsxs("span",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["(",a," reviews)"]})]})},ee=()=>{const{mentorId:s}=O(),{user:a}=F(),[t,o]=n.useState(null),[r,d]=n.useState([]),[M,E]=n.useState(0),[S,g]=n.useState(!0),[y,f]=n.useState(""),[h,q]=n.useState(!1),[b,j]=n.useState(!1),[N,v]=n.useState(""),[L,P]=n.useState(null);n.useEffect(()=>{(async()=>{if(console.log("Fetching profile for mentorId:",s),!s){f("No mentor ID provided in the URL."),g(!1);return}g(!0),f("");try{const i=x.get(`/users/${s}`),C=x.get(`/reviews/mentor/${s}`),u=await Promise.allSettled([i,C]);let p,m;if(u[0].status==="fulfilled")p=u[0].value,o(p.data);else throw console.error("Error fetching user profile:",u[0].reason),new Error("Failed to fetch user profile.");if(u[1].status==="fulfilled"){if(m=u[1].value,p.data.role==="MENTOR"&&(d(m.data),m.data.length>0)){const D=m.data.reduce((U,I)=>U+I.rating,0);E(D/m.data.length)}}else console.warn("Could not fetch reviews:",u[1].reason)}catch(i){f(i.message||"An unexpected error occurred."),console.error("Full error object:",i)}finally{g(!1)}})()},[s]);const $=async()=>{v(""),j(!0);try{await x.post("/requests",{mentorId:t.id}),q(!0),P("PENDING"),k.success("Mentorship request sent successfully!")}catch(l){const i=l.response?.status===409?"You have already sent a request to this mentor.":"Failed to send request. Please try again.";v(i),k.error(i)}finally{j(!1)}};if(S)return e.jsx("p",{className:"text-center text-gray-500 mt-10",children:"Loading user profile..."});if(y)return e.jsx("p",{className:"text-center text-red-500 mt-10",children:y});if(!t)return e.jsx("p",{className:"text-center text-gray-500 mt-10",children:"This user could not be found."});const A=()=>t.profile?.avatarUrl?t.profile.avatarUrl.startsWith("http")?t.profile.avatarUrl:`${x.defaults.baseURL}${t.profile.avatarUrl}`.replace("/api",""):`https://ui-avatars.com/api/?name=${encodeURIComponent(t.profile?.name||t.email)}&background=random&color=fff&size=128`;let c="Request Mentorship";if(h)switch(L){case"PENDING":c="Request Pending...";break;case"ACCEPTED":c="Mentorship Accepted!";break;case"REJECTED":c="Request Rejected";break;case"CANCELLED":c="Request Cancelled";break;default:c="Request Sent âœ“"}const T=b?e.jsx(Y,{}):c;return e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 min-h-screen p-4 sm:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden",children:[e.jsx("div",{className:"h-48 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 relative",children:e.jsx("img",{src:A(),alt:`Avatar of ${t.profile?.name||t.email}`,className:"w-32 h-32 rounded-full object-cover border-4 border-white dark:border-gray-800 absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-1/2 shadow-lg"})}),e.jsxs("div",{className:"pt-20 pb-8 px-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t.profile?.name||t.email}),e.jsxs("span",{className:`mt-2 inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ${t.role==="MENTOR"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"}`,children:[t.role==="MENTOR"?e.jsx(V,{size:16,className:"mr-1.5"}):e.jsx(_,{size:16,className:"mr-1.5"}),t.role]}),t.role==="MENTOR"&&r.length>0&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx(R,{rating:M,totalReviews:r.length})}),t.lastSeen&&e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-2",children:J(t.lastSeen)})]}),e.jsxs("div",{className:"border-t dark:border-gray-700 px-8 py-6 space-y-6 text-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"About Me"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.profile?.bio||"No bio provided."})]}),t.profile?.skills&&t.profile.skills.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3",children:"Skills & Expertise"}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:t.profile.skills.map(l=>e.jsx("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm font-medium",children:l},l))})]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 px-8 py-4 flex flex-col sm:flex-row justify-center items-center gap-4",children:a&&a.id===s?e.jsxs(w,{to:"/profile/edit",className:"w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 shadow-md transition-all",children:[e.jsx(B,{size:20})," Edit My Profile"]}):a&&a.role==="MENTEE"&&t.role==="MENTOR"?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:$,disabled:h||b,className:`w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 text-white rounded-lg font-semibold transition-all ${h?"bg-gray-500 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 shadow-md"}`,children:[e.jsx(G,{size:20})," ",T]}),e.jsxs(w,{to:`/book-session/${s}`,className:"w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 shadow-md transition-all",children:[e.jsx(W,{size:20})," Book a Session"]})]}):null}),N&&e.jsx("p",{className:"text-red-500 text-sm text-center py-2",children:N})]}),t.role==="MENTOR"&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"What Mentees Are Saying"}),r.length>0?e.jsx("div",{className:"space-y-6",children:r.map(l=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(R,{rating:l.rating,totalReviews:0}),e.jsx("p",{className:"ml-4 font-bold text-gray-800 dark:text-gray-200",children:l.mentorshipRequest?.mentee?.profile?.name||"A Mentee"})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 italic",children:['"',l.comment,'"']})]},l.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"This mentor doesn't have any reviews yet."})]})]})})};export{ee as default};
