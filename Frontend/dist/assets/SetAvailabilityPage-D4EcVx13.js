import{r as d,c as m,j as e,V as c}from"./index-D8cSyDI9.js";const f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w=()=>{const[i,l]=d.useState([]),[u,y]=d.useState(!0),o=d.useCallback(async()=>{y(!0);try{const a=await m.get("/sessions/availability/me");if(a.data&&a.data.length>0){const r=a.data.reduce((s,t)=>{const n=`${t.startTime}-${t.endTime}`;return s[n]||(s[n]={id:Math.random(),startTime:t.startTime,endTime:t.endTime,days:[]}),s[n].days.push(t.day),s},{});l(Object.values(r))}else l([])}catch{console.log("No existing availability found or error fetching."),l([])}finally{y(!1)}},[]);d.useEffect(()=>{o()},[o]);const g=()=>{l([...i,{id:Date.now(),days:[],startTime:"09:00",endTime:"17:00"}])},x=a=>{l(i.filter(r=>r.id!==a))},b=(a,r,s)=>{l(i.map(t=>t.id===a?{...t,[r]:s}:t))},h=(a,r)=>{l(i.map(s=>{if(s.id===a){const t=s.days.includes(r)?s.days.filter(n=>n!==r):[...s.days,r];return{...s,days:t}}return s}))},p=async a=>{a.preventDefault();const r=i.flatMap(t=>t.days.map(n=>({day:n,startTime:t.startTime,endTime:t.endTime})));for(const t of r)if(t.startTime>=t.endTime){c.error(`Error in a time slot for ${t.day}: End time must be after start time.`);return}const s=m.post("/sessions/availability",{availability:r});c.promise(s,{loading:"Saving availability...",success:t=>(o(),"Availability updated successfully!"),error:t=>t.response?.data?.message||"Failed to save availability. Please try again."})},v=async()=>{if(window.confirm("Are you sure you want to clear your entire weekly availability?")){const a=m.post("/sessions/availability",{availability:[]});c.promise(a,{loading:"Clearing your availability...",success:()=>(l([]),"Your availability has been cleared."),error:"Failed to clear availability."})}};return u?e.jsx("p",{className:"text-center text-gray-500",children:"Loading your schedule..."}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Set Your Weekly Availability"}),e.jsx("button",{onClick:p,className:"w-full sm:w-auto px-6 py-2 border-none rounded-lg bg-blue-600 text-white font-semibold cursor-pointer transition-colors hover:bg-blue-700",children:"Save Availability"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-8 rounded-lg shadow-lg space-y-6",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Define blocks of time when you are typically available for mentorship sessions each week. You can add multiple blocks to accommodate breaks."}),i.length===0&&!u&&e.jsx("div",{className:"text-center py-8",children:e.jsx("button",{onClick:g,className:"px-6 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors",children:"+ Add Your First Time Slot"})}),i.map(a=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("input",{type:"time",value:a.startTime,onChange:r=>b(a.id,"startTime",r.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600"}),e.jsx("span",{className:"font-semibold dark:text-gray-300",children:"-"}),e.jsx("input",{type:"time",value:a.endTime,onChange:r=>b(a.id,"endTime",r.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600"}),e.jsx("button",{onClick:()=>x(a.id),className:"text-red-500 hover:text-red-700","aria-label":"Remove time block",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(r=>e.jsx("button",{type:"button",onClick:()=>h(a.id,r),className:`px-3 py-1.5 text-sm font-medium rounded-full transition-colors ${a.days.includes(r)?"bg-blue-600 text-white shadow":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500"}`,children:r.substring(0,3)},r))})]},a.id)),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:g,className:"w-full py-2 text-sm text-blue-600 dark:text-blue-400 border-2 border-dashed border-blue-400 dark:border-blue-500 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50",children:"+ Add another time block"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:v,className:"text-sm text-red-500 hover:underline",children:"Clear All Availability"})})]})]})]})};export{w as default};
