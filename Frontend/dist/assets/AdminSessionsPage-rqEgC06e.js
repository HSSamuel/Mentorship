import{h as Z,u as ee,r,l as se,j as e,L as u,c as D,V as M}from"./index-kKR_KBkN.js";import{E as te,r as p}from"./index-DgWsfuLe.js";import{T as ae}from"./trash-2-B9BHOJJO.js";import{S as re}from"./search-D05ddwCM.js";import{X as ne}from"./x-DXMF_Mqo.js";import{S as ie}from"./star-BK8Kjp4V.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],oe=Z("info",le),de=({isOpen:d,onClose:x,onConfirm:a,title:g,children:c})=>d?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:g}),e.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:c}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:x,className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",children:"Confirm"})]})]})}):null,ce=({isOpen:d,onClose:x,session:a})=>{if(!d||!a)return null;const g=({rating:c})=>e.jsx("div",{className:"flex",children:[...Array(5)].map((y,m)=>e.jsx(ie,{className:`w-6 h-6 ${m<c?"text-yellow-400":"text-gray-300"}`,fill:"currentColor"},m))});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-xl w-full max-w-lg relative",children:[e.jsx("button",{onClick:x,className:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(ne,{size:24})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Session Feedback"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:"Rating Provided:"}),e.jsx("div",{className:"mt-1",children:a.rating?e.jsx(g,{rating:a.rating}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No rating was given."})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:"Comments:"}),e.jsx("p",{className:"mt-1 text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 p-3 rounded-md whitespace-pre-wrap",children:a.feedback||"No comments were provided."})]})]})]})})},ye=()=>{const{token:d}=ee(),[x,a]=r.useState([]),[g,c]=r.useState(0),[y,m]=r.useState(!0),[b,E]=r.useState(""),[F,f]=r.useState(!1),[T,O]=r.useState(null),[A,j]=r.useState(!1),[h,N]=r.useState(null),L=async()=>{m(!0);try{const s=await D.get("/admin/sessions");if(Array.isArray(s.data.sessions)){const n=s.data.sessions.map(l=>({...l,status:new Date(l.date)<new Date?"COMPLETED":"UPCOMING"}));a(n)}c(s.data.totalCount)}catch{E("Failed to fetch sessions.")}finally{m(!1)}};r.useEffect(()=>{L()},[]),r.useEffect(()=>{if(d){const s=se("http://localhost:5000/api",{auth:{token:d}}),n=t=>{const o={...t,status:new Date(t.date)<new Date?"COMPLETED":"UPCOMING"};a(i=>i.map(P=>P.id===o.id?o:P))},l=t=>{const o={...t,status:new Date(t.date)<new Date?"COMPLETED":"UPCOMING"};a(i=>[o,...i]),c(i=>i+1)};return s.on("sessionUpdated",n),s.on("newSession",l),()=>{s.disconnect()}}},[d]);const I=s=>{O(s),f(!0)},H=s=>{N(s),j(!0)},k=()=>{N(null),j(!1)},G=async()=>{if(h)try{await D.delete(`/admin/sessions/${h.id}`),a(s=>s.filter(n=>n.id!==h.id)),c(s=>s-1),M.success("Session deleted successfully.")}catch(s){M.error("Failed to delete session."),console.error(s)}finally{k()}},z=r.useMemo(()=>[{Header:"Session Info",accessor:"topic",Cell:({row:s})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-800 dark:text-white",children:s.original.isGroupSession?s.original.topic:"1-on-1 Session"}),e.jsx("span",{className:"text-xs text-gray-500",children:s.original.id})]})},{Header:"Mentor",accessor:"mentor.profile.name",Cell:({row:s})=>s.original.mentor&&s.original.mentor.id?e.jsx(u,{to:`/mentor/${s.original.mentor.id}`,className:"text-blue-600 hover:underline",children:s.original.mentor.profile?.name||"N/A"}):e.jsx(e.Fragment,{children:s.original.mentor?.profile?.name||"N/A (Invalid)"})},{Header:"Participants",accessor:"mentee.profile.name",Cell:({row:s})=>s.original.isGroupSession?e.jsxs("div",{className:"flex items-center",children:[s.original.participants?.length||0," /"," ",s.original.maxParticipants]}):s.original.mentee&&s.original.mentee.id?e.jsx(u,{to:`/mentor/${s.original.mentee.id}`,className:"text-blue-600 hover:underline",children:s.original.mentee.profile?.name||"N/A"}):e.jsx(e.Fragment,{children:s.original.mentee?.profile?.name||"N/A (Invalid)"})},{Header:"Date",accessor:"date",Cell:({value:s})=>new Date(s).toLocaleString()},{Header:"Status",accessor:"status",Cell:({value:s})=>e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s==="COMPLETED"?"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"}`,children:s})},{Header:"Actions",accessor:"id",Cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{to:`/session/${s.original.id}/insights`,className:"p-1.5 text-gray-500 hover:text-green-600",title:"View Details",children:e.jsx(oe,{size:16})}),(s.original.rating||s.original.feedback)&&e.jsx("button",{onClick:()=>I(s.original),className:"p-1.5 text-gray-500 hover:text-blue-600",title:"View Feedback",children:e.jsx(te,{size:16})}),e.jsx("button",{onClick:()=>H(s.original),className:"p-1.5 text-gray-500 hover:text-red-600",title:"Delete Session",children:e.jsx(ae,{size:16})})]})}],[]),{getTableProps:R,getTableBodyProps:V,headerGroups:$,prepareRow:U,page:v,canPreviousPage:S,canNextPage:C,pageOptions:B,pageCount:_,gotoPage:w,nextPage:X,previousPage:Y,setPageSize:q,state:{pageIndex:J,pageSize:K,globalFilter:Q},setGlobalFilter:W}=p.useTable({columns:z,data:x,initialState:{pageIndex:0,pageSize:10}},p.useGlobalFilter,p.useSortBy,p.usePagination);return y?e.jsx("p",{className:"p-8 text-center",children:"Loading all sessions..."}):b?e.jsx("p",{className:"p-8 text-center text-red-500",children:b}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["All Sessions (",g,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search sessions...",value:Q||"",onChange:s=>W(s.target.value),className:"w-full md:w-64 pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{...R(),className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:$.map(s=>{const{key:n,...l}=s.getHeaderGroupProps();return e.jsx("tr",{...l,children:s.headers.map(t=>{const{key:o,...i}=t.getHeaderProps(t.getSortByToggleProps());return e.jsxs("th",{...i,className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer",children:[t.render("Header"),e.jsx("span",{className:"ml-1",children:t.isSorted?t.isSortedDesc?"ðŸ”½":"ðŸ”¼":""})]},o)})},n)})}),e.jsx("tbody",{...V(),className:"divide-y divide-gray-200 dark:divide-gray-700",children:v.map(s=>{U(s);const{key:n,...l}=s.getRowProps();return e.jsx("tr",{...l,className:"hover:bg-gray-50 dark:hover:bg-gray-600",children:s.cells.map(t=>{const{key:o,...i}=t.getCellProps();return e.jsx("td",{...i,className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300",children:t.render("Cell")},o)})},n)})})]})}),v.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"No Sessions Found"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Your search did not match any sessions."})]})]}),e.jsxs("div",{className:"py-3 flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-200",children:["Page ",e.jsx("span",{className:"font-medium",children:J+1})," of"," ",e.jsx("span",{className:"font-medium",children:B.length})]}),e.jsx("select",{value:K,onChange:s=>{q(Number(s.target.value))},className:"p-1 border rounded-md dark:bg-gray-700 dark:border-gray-600",children:[10,20,50].map(s=>e.jsxs("option",{value:s,children:["Show ",s]},s))})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>w(0),disabled:!S,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 hover:bg-gray-50",children:"First"}),e.jsx("button",{onClick:()=>Y(),disabled:!S,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Prev"}),e.jsx("button",{onClick:()=>X(),disabled:!C,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"}),e.jsx("button",{onClick:()=>w(_-1),disabled:!C,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Last"})]})})]}),e.jsx(ce,{isOpen:F,onClose:()=>f(!1),session:T}),e.jsx(de,{isOpen:A,onClose:k,onConfirm:G,title:"Confirm Session Deletion",children:e.jsx("p",{children:"Are you sure you want to delete this session? This action cannot be undone."})})]})};export{ye as default};
