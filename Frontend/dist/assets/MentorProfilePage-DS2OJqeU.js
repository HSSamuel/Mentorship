import{f as P,u as A,r as n,j as e,L as C,c as x}from"./index-C_tbM6aH.js";const U=a=>{if(!a)return"N/A";const s=new Date(a),o=Math.round((new Date().getTime()-s.getTime())/(1e3*60)),l=Math.round(o/60),i=Math.round(l/24);return o<1?"Online":o<60?`Last seen ${o} minute${o===1?"":"s"} ago`:l<24?`Last seen ${l} hour${l===1?"":"s"} ago`:i===1?"Last seen yesterday":i<7?`Last seen ${i} day${i===1?"":"s"} ago`:`Last seen ${s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`},I=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),E=({rating:a,totalReviews:s})=>{const t=Math.round(a);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((o,l)=>e.jsx("svg",{className:`w-5 h-5 ${l<t?"text-yellow-400":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},l))}),e.jsxs("span",{className:"text-gray-600 text-sm",children:["(",s," reviews)"]})]})},G=()=>{const{id:a}=P(),{user:s}=A(),[t,o]=n.useState(null),[l,i]=n.useState([]),[R,p]=n.useState(0),[k,b]=n.useState(!0),[y,M]=n.useState(""),[h,u]=n.useState(!1),[g,N]=n.useState(!1),[j,w]=n.useState(""),[v,m]=n.useState(null),q=async()=>{if(s&&s.role==="MENTEE"&&a)try{const r=await x.get(`/requests/status/${a}`);r.data.exists?(u(!0),m(r.data.status)):(u(!1),m(null))}catch(r){console.warn("Could not check mentorship request status:",r),u(!1),m(null)}else s&&s.role!=="MENTEE"&&(u(!0),m("N/A"))};n.useEffect(()=>{(async()=>{b(!0);try{const[d,f]=await Promise.all([x.get(`/users/${a}`),x.get(`/reviews/mentor/${a}`)]);if(o(d.data),d.data.role==="MENTOR"){if(i(f.data),f.data.length>0){const T=f.data.reduce(($,D)=>$+D.rating,0);p(T/f.data.length)}}else i([]),p(0);s&&await q()}catch(d){M("User profile not found or an error occurred."),console.error(d)}finally{b(!1)}})()},[a,s]);const S=async()=>{w(""),N(!0);try{await x.post("/requests",{mentorId:t.id}),u(!0),m("PENDING")}catch(r){const d=r.response?.status===409?"You have already sent a request to this mentor.":"Failed to send request. Please try again.";w(d),console.error(r)}finally{N(!1)}};if(k)return e.jsx("p",{className:"text-center text-gray-500 mt-10",children:"Loading user profile... "});if(y)return e.jsx("p",{className:"text-center text-red-500 mt-10",children:y});if(!t)return e.jsx("p",{className:"text-center text-gray-500 mt-10",children:"This user could not be found. "});const L=()=>t.profile?.avatarUrl?t.profile.avatarUrl.startsWith("http")?t.profile.avatarUrl:`${x.defaults.baseURL}${t.profile.avatarUrl}`.replace("/api",""):`https://ui-avatars.com/api/?name=${encodeURIComponent(t.profile.name)}&background=random&color=fff`;let c="Request Mentorship";if(h)switch(v){case"PENDING":c="Request Pending...";break;case"ACCEPTED":c="Mentorship Accepted!";break;case"REJECTED":c="Request Rejected";break;case"CANCELLED":c="Request Cancelled";break;default:c="Request Sent âœ“"}return g&&(c=e.jsx(I,{})),e.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-slate-800 dark:to-gray-900 rounded-lg shadow-xl dark:shadow-none overflow-hidden",children:[e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start text-center md:text-left",children:[e.jsx("img",{src:L(),alt:`Avatar of ${t.profile.name}`,className:"w-32 h-32 rounded-full object-cover flex-shrink-0 mb-6 md:mb-0 md:mr-8 border-2 border-blue-200 dark:border-blue-700"}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:[t.profile.name," "]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 text-sm mt-1",children:[t.role," "]}),t.role==="MENTOR"&&l.length>0&&e.jsx("div",{className:"mt-2 flex justify-center md:justify-start",children:e.jsx(E,{rating:R,totalReviews:l.length})}),t.lastSeen&&e.jsxs("p",{className:"text-gray-500 dark:text-gray-300 text-sm mt-1",children:[" ",U(t.lastSeen)," "]}),e.jsx("p",{className:"mt-4 text-lg text-gray-600 dark:text-gray-200",children:t.profile.bio})," ",s&&s.id===a?e.jsx(C,{to:"/profile/edit",className:"mt-6 inline-block px-8 py-3 text-lg font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Edit My Profile"}):s&&s.role==="MENTEE"&&t.role==="MENTOR"&&e.jsx("button",{onClick:S,disabled:h||g,className:`mt-6 inline-block px-8 py-3 text-lg font-semibold text-white rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 flex justify-center items-center ${h?v==="ACCEPTED"?"bg-green-600 cursor-not-allowed":"bg-blue-500 cursor-not-allowed":g?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}`,children:c}),s&&s.id!==a&&t.role==="MENTEE"&&e.jsx("p",{className:"mt-6 text-gray-600 dark:text-gray-300 text-sm",children:"This is a mentee profile."}),s&&s.id!==a&&s.role==="MENTOR"&&t.role==="MENTOR"&&e.jsx("p",{className:"mt-6 text-gray-600 dark:text-gray-300 text-sm",children:"You are both mentors. Direct mentorship requests are typically mentee-to-mentor."}),!s&&e.jsx("p",{className:"mt-6 text-gray-600 dark:text-gray-300 text-sm",children:"Log in to interact with this user."}),j&&e.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:j})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border-t border-gray-200 dark:border-gray-700 px-8 py-6",children:[" ",e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4",children:[" ","Skills & Expertise"]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:t.profile.skills.map(r=>e.jsx("span",{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-200 text-sm font-medium px-3 py-1 rounded-full",children:r},r))})]})]}),t.role==="MENTOR"&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"What Mentees Are Saying"}),l.length>0?e.jsx("div",{className:"space-y-6",children:l.map(r=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-md",children:[" ",e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(E,{rating:r.rating,totalReviews:0}),e.jsx("p",{className:"ml-4 font-bold text-gray-800 dark:text-gray-200",children:r.mentorshipRequest.mentee.profile.name})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 italic",children:['"',r.comment,'"']})]},r.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"This mentor doesn't have any reviews yet."})]})]})};export{G as default};
