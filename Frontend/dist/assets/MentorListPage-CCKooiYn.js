import{j as e,r as s,c as x,u as I,L as q,V as z}from"./index-kKR_KBkN.js";import{S as M,M as T}from"./StatCardSkeleton-D7Fd_rgu.js";const B=({skills:r,selectedSkill:c,onSkillChange:g,searchQuery:m,onSearchChange:d,minExperience:n,onMinExperienceChange:w,language:b,onLanguageChange:k})=>e.jsx("aside",{className:"w-full md:w-64 lg:w-72 flex-shrink-0",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg sticky top-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Filters"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"search-filter",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Search by Name or Bio"}),e.jsx("input",{id:"search-filter",type:"text",placeholder:"e.g., John Doe",value:m,onChange:l=>d(l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"skill-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Skill"}),e.jsxs("select",{id:"skill-filter",value:c,onChange:l=>g(l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"All Skills"}),r.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"experience-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Years of Experience"}),e.jsx("input",{id:"experience-filter",type:"number",min:"0",value:n,onChange:l=>w(parseInt(l.target.value,10)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Language"}),e.jsx("input",{id:"language-filter",type:"text",placeholder:"e.g., English",value:b,onChange:l=>k(l.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]})}),D=({session:r,onJoin:c})=>{const{user:g}=I(),m=r.participants?.some(n=>n.menteeId===g?.id),d=r.maxParticipants&&r._count.participants>=r.maxParticipants;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden flex flex-col h-full",children:[e.jsxs("div",{className:"p-6 flex-grow",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:r.topic}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("img",{src:r.mentor.profile?.avatarUrl||`https://ui-avatars.com/api/?name=${r.mentor.profile?.name}&background=random&color=fff`,alt:r.mentor.profile?.name,className:"w-8 h-8 rounded-full mr-3 object-cover"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Hosted by"," ",e.jsx(q,{to:`/mentor/${r.mentor.id}`,className:"text-blue-600 hover:underline",children:r.mentor.profile?.name})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:new Date(r.date).toLocaleString([],{dateStyle:"medium",timeStyle:"short"})}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3.005 3.005 0 013.75-2.906z"})}),e.jsxs("span",{children:[r._count.participants," / ",r.maxParticipants," spots filled"]})]})]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4",children:e.jsx("button",{onClick:()=>c(r.id),disabled:m||d,className:`w-full px-4 py-2 text-sm font-semibold rounded-md transition-colors ${m?"bg-gray-400 text-gray-700 cursor-not-allowed":d?"bg-red-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:m?"Already Joined":d?"Session Full":"Join the Circle"})})]})},Y=()=>{const[r,c]=s.useState([]),[g,m]=s.useState([]),[d,n]=s.useState([]),[w,b]=s.useState(!0),[k,l]=s.useState(new Set),[u,v]=s.useState(1),[p,F]=s.useState(1),[f,E]=s.useState(""),[h,A]=s.useState(""),[y,R]=s.useState(0),[j,J]=s.useState(""),[a,N]=s.useState("recommended"),[L,P]=s.useState([]),S=s.useCallback(async()=>{b(!0);try{const[t,o]=await Promise.all([x.get("/users/skills"),x.get("/requests/sent")]);m(t.data);const C=new Set(o.data.map(i=>i.mentorId));if(l(C),a==="recommended"){const i=await x.get("/users/mentors/recommended");c(i.data),n(i.data),F(1),v(1)}else if(a==="browse"){const i=await x.get(`/users/mentors?page=${u}&limit=9`);c(i.data.mentors),n(i.data.mentors),F(i.data.totalPages)}else if(a==="circles"){const i=await x.get("/sessions/group");P(i.data)}}catch(t){console.error("Failed to fetch data:",t),c([]),n([]),P([])}finally{b(!1)}},[a,u]);s.useEffect(()=>{S()},[S]),s.useEffect(()=>{if(a==="browse"){let t=r;f&&(t=t.filter(o=>o.profile?.skills?.includes(f))),h&&(t=t.filter(o=>(o.profile?.name?.toLowerCase()||"").includes(h.toLowerCase())||(o.profile?.bio?.toLowerCase()||"").includes(h.toLowerCase()))),y>0&&(t=t.filter(o=>o.profile?.yearsOfExperience>=y)),j&&(t=t.filter(o=>o.profile?.languages?.includes(j))),n(t)}else n(r)},[f,h,y,j,r,a]);const $=async t=>{const o=x.post(`/sessions/${t}/join`);z.promise(o,{loading:"Joining the circle...",success:()=>(S(),"Successfully joined the circle!"),error:C=>C.response?.data?.message||"Failed to join the circle."})};return e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[a==="browse"&&e.jsx(B,{skills:g,selectedSkill:f,onSkillChange:E,searchQuery:h,onSearchChange:A,minExperience:y,onMinExperienceChange:R,language:j,onLanguageChange:J}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-center mb-6 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>N("recommended"),className:`px-4 py-2 text-sm font-semibold transition-colors duration-200 ${a==="recommended"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-blue-500"}`,children:"âœ¨ Recommended For You"}),e.jsx("button",{onClick:()=>N("browse"),className:`px-4 py-2 text-sm font-semibold transition-colors duration-200 ${a==="browse"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-blue-500"}`,children:"ðŸ” Browse All Mentors"}),e.jsx("button",{onClick:()=>N("circles"),className:`px-4 py-2 text-sm font-semibold transition-colors duration-200 ${a==="circles"?"border-b-2 border-green-600 text-green-600":"text-gray-500 hover:text-green-500"}`,children:"ðŸ§‘â€ðŸ¤â€ðŸ§‘ Mentoring Circles"})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6 text-center",children:a==="recommended"?"Top Mentor Matches":a==="browse"?"Find Your Mentor":"Join a Mentoring Circle"}),w?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[e.jsx(M,{}),e.jsx(M,{}),e.jsx(M,{})]}):e.jsx(e.Fragment,{children:a==="circles"?L.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:L.map(t=>e.jsx(D,{session:t,onJoin:$},t.id))}):e.jsxs("div",{className:"text-center py-16 px-6 bg-white rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"No Upcoming Circles"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"There are no group sessions scheduled at the moment. Check back soon!"})]}):d.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:d.map(t=>e.jsx(T,{mentor:t,isAlreadyRequested:k.has(t.id)},t.id))}),a==="browse"&&p>1&&e.jsxs("div",{className:"flex justify-center items-center mt-8 gap-4",children:[e.jsx("button",{onClick:()=>v(t=>Math.max(t-1,1)),disabled:u===1,className:"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",u," of ",p]}),e.jsx("button",{onClick:()=>v(t=>Math.min(t+1,p)),disabled:u===p,className:"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})]}):e.jsxs("div",{className:"text-center py-16 px-6 bg-white rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"No Mentors Found"}),e.jsx("p",{className:"text-gray-500 mt-2",children:a==="recommended"?"Update your profile skills and goals for better matches.":"Try adjusting your filters or check back later."})]})})]})]})};export{Y as default};
