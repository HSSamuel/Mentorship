import{r as o,c,j as e,V as d}from"./index-kKR_KBkN.js";const S=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],M=()=>{const[i,l]=o.useState([]),[y,h]=o.useState(!0),[m,b]=o.useState(""),[u,p]=o.useState(""),[g,v]=o.useState(5),x=o.useCallback(async()=>{h(!0);try{const a=await c.get("/sessions/availability/me");if(a.data&&a.data.length>0){const t=a.data.reduce((r,s)=>{const n=`${s.startTime}-${s.endTime}`;return r[n]||(r[n]={id:Math.random(),startTime:s.startTime,endTime:s.endTime,days:[]}),r[n].days.push(s.day),r},{});l(Object.values(t))}else l([])}catch{console.log("No existing availability found or error fetching."),l([])}finally{h(!1)}},[]);o.useEffect(()=>{x()},[x]);const f=()=>{l([...i,{id:Date.now(),days:[],startTime:"09:00",endTime:"17:00"}])},j=a=>{l(i.filter(t=>t.id!==a))},k=(a,t,r)=>{l(i.map(s=>s.id===a?{...s,[t]:r}:s))},w=(a,t)=>{l(i.map(r=>{if(r.id===a){const s=r.days.includes(t)?r.days.filter(n=>n!==t):[...r.days,t];return{...r,days:s}}return r}))},N=async a=>{a.preventDefault();const t=i.flatMap(s=>s.days.map(n=>({day:n,startTime:s.startTime,endTime:s.endTime})));for(const s of t)if(s.startTime>=s.endTime){d.error(`Error in a time slot for ${s.day}: End time must be after start time.`);return}const r=c.post("/sessions/availability",{availability:t});d.promise(r,{loading:"Saving availability...",success:s=>(x(),"Availability updated successfully!"),error:s=>s.response?.data?.message||"Failed to save availability. Please try again."})},T=async a=>{if(a.preventDefault(),!m||!u||!g){d.error("Please fill out all fields for the group session.");return}const t=c.post("/sessions/group",{topic:m,sessionTime:u,maxParticipants:g,isGroupSession:!0});d.promise(t,{loading:"Scheduling your Mentoring Circle...",success:()=>(b(""),p(""),v(5),"Group session scheduled successfully!"),error:r=>r.response?.data?.message||"Failed to schedule group session. Please try again."})},C=async()=>{if(window.confirm("Are you sure you want to clear your entire weekly availability?")){const a=c.post("/sessions/availability",{availability:[]});d.promise(a,{loading:"Clearing your availability...",success:()=>(l([]),"Your availability has been cleared."),error:"Failed to clear availability."})}};return y?e.jsx("p",{className:"text-center text-gray-500",children:"Loading your schedule..."}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Set Your Weekly Availability"}),e.jsx("button",{onClick:N,className:"w-full sm:w-auto px-6 py-2 border-none rounded-lg bg-blue-600 text-white font-semibold cursor-pointer transition-colors hover:bg-blue-700",children:"Save Availability"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-8 rounded-lg shadow-lg space-y-6",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Define blocks of time when you are typically available for 1-on-1 mentorship sessions each week. You can add multiple blocks to accommodate breaks."}),i.length===0&&!y&&e.jsx("div",{className:"text-center py-8",children:e.jsx("button",{onClick:f,className:"px-6 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors",children:"+ Add Your First Time Slot"})}),i.map(a=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("input",{type:"time",value:a.startTime,onChange:t=>k(a.id,"startTime",t.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600"}),e.jsx("span",{className:"font-semibold dark:text-gray-300",children:"-"}),e.jsx("input",{type:"time",value:a.endTime,onChange:t=>k(a.id,"endTime",t.target.value),className:"w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600"}),e.jsx("button",{onClick:()=>j(a.id),className:"text-red-500 hover:text-red-700","aria-label":"Remove time block",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(t=>e.jsx("button",{type:"button",onClick:()=>w(a.id,t),className:`px-3 py-1.5 text-sm font-medium rounded-full transition-colors ${a.days.includes(t)?"bg-blue-600 text-white shadow":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500"}`,children:t.substring(0,3)},t))})]},a.id)),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:f,className:"w-full py-2 text-sm text-blue-600 dark:text-blue-400 border-2 border-dashed border-blue-400 dark:border-blue-500 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/50",children:"+ Add another time block"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:C,className:"text-sm text-red-500 hover:underline",children:"Clear All Availability"})})]})]}),e.jsxs("div",{className:"mt-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Create a Mentoring Circle"}),e.jsxs("form",{onSubmit:T,className:"bg-white dark:bg-gray-800 p-4 sm:p-8 rounded-lg shadow-lg space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Schedule a one-time group session on a specific topic. Mentees with similar interests will be able to join your circle."}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"topic",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Session Topic"}),e.jsx("input",{type:"text",id:"topic",value:m,onChange:a=>b(a.target.value),placeholder:"e.g., UI/UX Design Portfolio Review",className:"mt-1 block w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sessionTime",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date and Time"}),e.jsx("input",{type:"datetime-local",id:"sessionTime",value:u,onChange:a=>p(a.target.value),className:"mt-1 block w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxParticipants",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Max Participants"}),e.jsx("input",{type:"number",id:"maxParticipants",value:g,onChange:a=>v(parseInt(a.target.value)),min:"2",max:"10",className:"mt-1 block w-full p-2 border rounded-md dark:bg-gray-700 dark:text-white dark:border-gray-600",required:!0})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"submit",className:"px-6 py-2 border-none rounded-lg bg-green-600 text-white font-semibold cursor-pointer transition-colors hover:bg-green-700",children:"Schedule Circle"})})]})]})]})};export{M as default};
