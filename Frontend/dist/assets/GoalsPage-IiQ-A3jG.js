import{r as a,j as e,V as S,c as N,u as M,L as F}from"./index-kKR_KBkN.js";import{G as q}from"./GoalList-DBzTTnSE.js";const E=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),T=({onGoalCreated:h,mentorships:w})=>{const[o,g]=a.useState(""),[b,p]=a.useState(""),[c,d]=a.useState(""),[m,u]=a.useState(""),[v,f]=a.useState(""),[j,s]=a.useState(""),[r,l]=a.useState(""),[y,k]=a.useState(!1),C=async t=>{if(t.preventDefault(),!r){S.error("Please select a mentorship to associate this goal with.");return}k(!0);try{const x=await N.post("/goals",{title:o,specific:b,measurable:c,achievable:m,relevant:v,timeBound:j,mentorshipRequestId:r,category:"Skill Development"});h(x.data),S.success("Goal created successfully!"),g(""),p(""),d(""),u(""),f(""),s(""),l("")}catch(x){console.error("Failed to create goal:",x.response?.data||x.message);const G=x.response?.data?.errors?.[0]?.msg||"Could not create goal. Please try again.";S.error(G)}finally{k(!1)}},i="mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-blue-500 focus:border-blue-500",n="block text-sm font-medium text-gray-700 dark:text-gray-300";return e.jsxs("form",{onSubmit:C,className:"p-4 bg-white dark:bg-gray-800 shadow-md rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mentorship",className:n,children:"Associate with Mentor"}),e.jsxs("select",{id:"mentorship",value:r,onChange:t=>l(t.target.value),required:!0,className:i,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Select a Mentor --"}),w.map(t=>e.jsx("option",{value:t.id,children:t.mentor.profile.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:n,children:"Goal Title"}),e.jsx("input",{id:"title",type:"text",value:o,onChange:t=>g(t.target.value),required:!0,className:i})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"specific",className:n,children:"Specific"}),e.jsx("textarea",{id:"specific",value:b,onChange:t=>p(t.target.value),required:!0,rows:2,className:i,placeholder:"What exactly do I want to accomplish?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"measurable",className:n,children:"Measurable"}),e.jsx("textarea",{id:"measurable",value:c,onChange:t=>d(t.target.value),required:!0,rows:2,className:i,placeholder:"How will I track my progress?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"achievable",className:n,children:"Achievable"}),e.jsx("textarea",{id:"achievable",value:m,onChange:t=>u(t.target.value),required:!0,rows:2,className:i,placeholder:"Is this goal realistic?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"relevant",className:n,children:"Relevant"}),e.jsx("textarea",{id:"relevant",value:v,onChange:t=>f(t.target.value),required:!0,rows:2,className:i,placeholder:"Why is this goal important to me?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timeBound",className:n,children:"Time-bound"}),e.jsx("textarea",{id:"timeBound",value:j,onChange:t=>s(t.target.value),required:!0,rows:2,className:i,placeholder:"What is the deadline?"})]}),e.jsx("button",{type:"submit",disabled:y,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-blue-500 disabled:cursor-not-allowed flex justify-center items-center",children:y?e.jsx(E,{}):"Set Goal"})]})},L=()=>{const{user:h}=M(),[w,o]=a.useState([]),[g,b]=a.useState([]),[p,c]=a.useState(!0),[d,m]=a.useState(null),u=a.useCallback(async()=>{if(h?.role!=="MENTEE"){c(!1);return}try{c(!0),m(null);const[s,r]=await Promise.all([N.get("/goals"),N.get("/requests/sent")]);o(s.data);const l=r.data.filter(y=>y.status==="ACCEPTED");b(l)}catch(s){m("Failed to fetch your data. Please try again later."),console.error(s)}finally{c(!1)}},[h]);a.useEffect(()=>{u()},[u]);const v=s=>{o(r=>[s,...r])},f=s=>{o(r=>r.map(l=>l.id===s.id?s:l))},j=s=>{o(r=>r.filter(l=>l.id!==s)),N.delete(`/goals/${s}`).catch(r=>{console.error("Failed to delete goal on server:",r),u()})};return p?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Loading..."}):h?.role==="MENTOR"?e.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Viewing Your Mentees' Goals"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"This page is for mentees to set their personal goals. You can view and manage the goals of your mentees from your dashboard."}),e.jsx(F,{to:"/my-sessions",className:"mt-4 inline-block px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Go to My Mentees"})]}):e.jsxs("div",{className:"container mx-auto p-4 md:p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-6",children:"My S.M.A.R.T. Goals"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 dark:text-gray-100",children:"Add a New Goal"}),e.jsx(T,{onGoalCreated:v,mentorships:g})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 dark:text-gray-100",children:"Current Goals"}),d&&e.jsx("p",{className:"text-red-500",children:d}),!d&&e.jsx(q,{goals:w,onUpdate:f,onDelete:j})]})]})]})};export{L as default};
