import{r,j as e,V as j,c as v,L as M}from"./index-DpNFJqVI.js";const F=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),A=({isOpen:d,onClose:c,onSave:l,goal:o})=>{const[p,m]=r.useState(""),[u,x]=r.useState(""),[t,i]=r.useState(""),[h,b]=r.useState(""),[N,a]=r.useState(""),[s,g]=r.useState(""),[w,k]=r.useState(""),[S,C]=r.useState(!1);if(r.useEffect(()=>{o?(m(o.title),x(o.description||""),i(o.specific||""),b(o.measurable||""),a(o.achievable||""),g(o.relevant||""),k(o.timeBound||"")):(m(""),x(""),i(""),b(""),a(""),g(""),k(""))},[o,d]),!d)return null;const G=async n=>{if(n.preventDefault(),!p||!t||!h||!N||!s||!w){j.error("Please fill out the Title and all S.M.A.R.T. goal fields.");return}C(!0);try{await l({title:p,description:u,specific:t,measurable:h,achievable:N,relevant:s,timeBound:w})}catch{}finally{C(!1)}},f="mt-1 block w-full px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",y="block text-sm font-medium text-gray-700 dark:text-gray-300";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-bold text-center text-gray-800 dark:text-gray-100 mb-4",children:o?"Edit Goal":"Add New Goal"}),e.jsxs("form",{onSubmit:G,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:y,children:"Goal Title"}),e.jsx("input",{type:"text",id:"title",value:p,onChange:n=>m(n.target.value),required:!0,className:f})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:y,children:"Description (Optional)"}),e.jsx("textarea",{id:"description",value:u,onChange:n=>x(n.target.value),className:f,rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"specific",className:y,children:"Specific"}),e.jsx("input",{type:"text",id:"specific",value:t,onChange:n=>i(n.target.value),required:!0,className:f,placeholder:"What exactly do I want to accomplish?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"measurable",className:y,children:"Measurable"}),e.jsx("input",{type:"text",id:"measurable",value:h,onChange:n=>b(n.target.value),required:!0,className:f,placeholder:"How will I track my progress?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"achievable",className:y,children:"Achievable"}),e.jsx("input",{type:"text",id:"achievable",value:N,onChange:n=>a(n.target.value),required:!0,className:f,placeholder:"Is this goal realistic?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"relevant",className:y,children:"Relevant"}),e.jsx("input",{type:"text",id:"relevant",value:s,onChange:n=>g(n.target.value),required:!0,className:f,placeholder:"Why is this goal important to me?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timeBound",className:y,children:"Time-bound"}),e.jsx("input",{type:"text",id:"timeBound",value:w,onChange:n=>k(n.target.value),required:!0,className:f,placeholder:"What is the deadline?"})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-2",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:S,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed flex items-center justify-center w-28",children:S?e.jsx(F,{}):o?"Save":"Add Goal"})]})]})]})})},$=({mentorshipId:d})=>{const[c,l]=r.useState([]),[o,p]=r.useState(!0),[m,u]=r.useState(!1),[x,t]=r.useState(null),i=async()=>{p(!0);try{const a=await v.get(`/goals/${d}`);l(a.data)}catch(a){console.error("Failed to fetch goals:",a)}finally{p(!1)}};r.useEffect(()=>{d&&i()},[d]);const h=async a=>{try{if(x){const{data:s}=await v.put(`/goals/${x.id}`,a);l(c.map(g=>g.id===s.id?s:g)),j.success("Goal updated!")}else{const{data:s}=await v.post("/goals",{...a,mentorshipRequestId:d});l([...c,s]),j.success("Goal added!")}u(!1),t(null)}catch(s){console.error("Failed to save goal:",s),j.error("Failed to save goal.")}},b=async a=>{try{const{data:s}=await v.put(`/goals/${a.id}`,{isCompleted:!a.isCompleted});l(c.map(g=>g.id===s.id?s:g))}catch(s){console.error("Failed to update goal status:",s)}},N=async a=>{if(window.confirm("Are you sure you want to delete this goal?"))try{await v.delete(`/goals/${a}`),l(c.filter(s=>s.id!==a)),j.success("Goal deleted.")}catch(s){console.error("Failed to delete goal:",s),j.error("Failed to delete goal.")}};return o?e.jsx("p",{className:"text-gray-500",children:"Loading goals..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-700 dark:text-gray-200",children:"Our Goals"}),e.jsx("button",{onClick:()=>{t(null),u(!0)},className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors",children:"+ Add New Goal"})]}),e.jsx("div",{className:"space-y-3",children:c.length>0?c.map(a=>e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.isCompleted,onChange:()=>b(a),className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("p",{className:`ml-4 ${a.isCompleted?"line-through text-gray-400":"text-gray-800 dark:text-gray-100"}`,children:a.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{t(a),u(!0)},className:"text-sm text-blue-500 hover:underline",children:"Edit"}),e.jsx("button",{onClick:()=>N(a.id),className:"text-sm text-red-500 hover:underline",children:"Delete"})]})]},a.id)):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No goals set yet. Add one to get started!"})}),m&&e.jsx(A,{isOpen:m,onClose:()=>{u(!1),t(null)},onSave:h,goal:x})]})},E=()=>{const[d,c]=r.useState([]),[l,o]=r.useState(null),[p,m]=r.useState(!0);r.useEffect(()=>{(async()=>{m(!0);try{const h=(await v.get("/requests/sent")).data.filter(b=>b.status==="ACCEPTED");c(h),h.length>0&&o(h[0])}catch(i){console.error("Failed to fetch matches:",i)}finally{m(!1)}})()},[]);const u=t=>t?.avatarUrl?t.avatarUrl.startsWith("http")?t.avatarUrl:`${v.defaults.baseURL}${t.avatarUrl}`.replace("/api",""):`https://ui-avatars.com/api/?name=${encodeURIComponent(t?.name||"User")}&background=random&color=fff`,x=t=>{if(!t)return console.error("Received an invalid date value from the backend:",t),"Date not available";const i=new Date(t);return isNaN(i.getTime())?(console.error("Could not parse the following date string:",t),"Invalid Date"):i.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return p?e.jsx("p",{className:"text-center text-gray-500",children:"Loading your mentors..."}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center text-gray-900 dark:text-white mb-8",children:"My Mentors"}),d.length>0?e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("aside",{className:"w-full md:w-1/3 lg:w-1/4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:d.map(t=>(console.log("Match object from API:",t),e.jsx("li",{children:e.jsxs("button",{onClick:()=>o(t),className:`w-full text-left p-4 transition-all duration-200 flex items-center ${l?.id===t.id?"bg-gradient-to-r from-purple-100 to-blue-100 dark:from-purple-900/50 dark:to-blue-900/50":"hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:[e.jsx("img",{src:u(t.mentor.profile),alt:`Avatar of ${t.mentor.profile.name}`,className:"w-10 h-10 rounded-full object-cover mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${l?.id===t.id?"text-purple-700 dark:text-purple-300":"text-gray-800 dark:text-gray-200"}`,children:t.mentor.profile.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Matched on ",x(t.updatedAt)]})]})]})},t.id)))})})}),e.jsx("main",{className:"flex-1",children:l?e.jsxs("div",{className:"rounded-xl shadow-2xl p-6 bg-gradient-to-br from-purple-100 via-blue-100 to-cyan-100 dark:from-purple-900/70 dark:via-blue-900/70 dark:to-cyan-900/70",children:[e.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-gray-300 dark:border-gray-600 mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:u(l.mentor.profile),alt:`Avatar of ${l.mentor.profile.name}`,className:"w-16 h-16 rounded-full object-cover mr-4 ring-2 ring-white/50"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:l.mentor.profile.name})]}),e.jsx(M,{to:`/book-session/${l.mentor.id}`,className:"px-5 py-2.5 text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg shadow-md hover:from-blue-600 hover:to-purple-700 transition-all duration-300",children:"Book a Session"})]}),e.jsx("div",{className:"bg-white/50 dark:bg-gray-800/50 p-6 rounded-lg",children:e.jsx($,{mentorshipId:l.id})})]}):e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Select a mentor to see details."})})]}):e.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"No Active Mentors"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"You have no active mentorships. Find a mentor to get started!"}),e.jsx(M,{to:"/mentors",className:"mt-4 inline-block px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Find a Mentor"})]})]})};export{E as default};
