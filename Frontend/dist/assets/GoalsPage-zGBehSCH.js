import{r,j as e,V as w,c as j,u as G,L as F}from"./index-BOyHK8Ne.js";const q=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),A=({onGoalCreated:i,mentorships:p})=>{const[o,c]=r.useState(""),[t,h]=r.useState(""),[n,m]=r.useState(""),[b,g]=r.useState(""),[v,f]=r.useState(""),[N,a]=r.useState(""),[l,d]=r.useState(""),[k,S]=r.useState(!1),C=async s=>{if(s.preventDefault(),!l){w.error("Please select a mentorship to associate this goal with.");return}S(!0);try{const y=await j.post("/goals",{title:o,specific:t,measurable:n,achievable:b,relevant:v,timeBound:N,mentorshipRequestId:l,category:"Skill Development"});i(y.data),w.success("Goal created successfully!"),c(""),h(""),m(""),g(""),f(""),a(""),d("")}catch(y){console.error("Failed to create goal:",y.response?.data||y.message);const M=y.response?.data?.errors?.[0]?.msg||"Could not create goal. Please try again.";w.error(M)}finally{S(!1)}},x="mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-200 focus:ring-blue-500 focus:border-blue-500",u="block text-sm font-medium text-gray-700 dark:text-gray-300";return e.jsxs("form",{onSubmit:C,className:"p-4 bg-white dark:bg-gray-800 shadow-md rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mentorship",className:u,children:"Associate with Mentor"}),e.jsxs("select",{id:"mentorship",value:l,onChange:s=>d(s.target.value),required:!0,className:x,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Select a Mentor --"}),p.map(s=>e.jsx("option",{value:s.id,children:s.mentor.profile.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:u,children:"Goal Title"}),e.jsx("input",{id:"title",type:"text",value:o,onChange:s=>c(s.target.value),required:!0,className:x})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"specific",className:u,children:"Specific"}),e.jsx("textarea",{id:"specific",value:t,onChange:s=>h(s.target.value),required:!0,rows:2,className:x,placeholder:"What exactly do I want to accomplish?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"measurable",className:u,children:"Measurable"}),e.jsx("textarea",{id:"measurable",value:n,onChange:s=>m(s.target.value),required:!0,rows:2,className:x,placeholder:"How will I track my progress?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"achievable",className:u,children:"Achievable"}),e.jsx("textarea",{id:"achievable",value:b,onChange:s=>g(s.target.value),required:!0,rows:2,className:x,placeholder:"Is this goal realistic?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"relevant",className:u,children:"Relevant"}),e.jsx("textarea",{id:"relevant",value:v,onChange:s=>f(s.target.value),required:!0,rows:2,className:x,placeholder:"Why is this goal important to me?"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timeBound",className:u,children:"Time-bound"}),e.jsx("textarea",{id:"timeBound",value:N,onChange:s=>a(s.target.value),required:!0,rows:2,className:x,placeholder:"What is the deadline?"})]}),e.jsx("button",{type:"submit",disabled:k,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-blue-500 disabled:cursor-not-allowed flex justify-center items-center",children:k?e.jsx(q,{}):"Set Goal"})]})},E=({goals:i,onUpdate:p,onDelete:o})=>{const c=async(t,h)=>{try{const n=await j.put(`/goals/${t.id}`,{status:h});p(n.data)}catch(n){console.error("Failed to update goal status:",n)}};return i.length===0?e.jsx("div",{className:"flex items-center justify-center h-full bg-white dark:bg-gray-800 rounded-lg shadow-md p-8",children:e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"You haven't set any goals yet. Add one to get started!"})}):e.jsx("div",{className:"space-y-4",children:i.map(t=>e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 shadow-md rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-gray-100",children:t.title}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.status==="Completed"?"bg-green-200 text-green-800 dark:bg-green-900/50 dark:text-green-200":"bg-yellow-200 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200"}`,children:t.status})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-700 dark:text-gray-300",children:"Specific:"})," ",t.specific]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-700 dark:text-gray-300",children:"Measurable:"})," ",t.measurable]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-700 dark:text-gray-300",children:"Achievable:"})," ",t.achievable]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-700 dark:text-gray-300",children:"Relevant:"})," ",t.relevant]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-700 dark:text-gray-300",children:"Time-bound:"})," ",t.timeBound]})]}),e.jsxs("div",{className:"mt-4 flex gap-4 border-t border-gray-200 dark:border-gray-700 pt-3",children:[e.jsx("button",{onClick:()=>c(t,"Completed"),className:"text-sm text-green-600 dark:text-green-400 hover:underline",children:"Mark as Complete"}),e.jsx("button",{onClick:()=>c(t,"InProgress"),className:"text-sm text-yellow-600 dark:text-yellow-400 hover:underline",children:"Mark as In Progress"}),e.jsx("button",{onClick:()=>o(t.id),className:"text-sm text-red-600 dark:text-red-400 hover:underline ml-auto",children:"Delete"})]})]},t.id))})},P=()=>{const{user:i}=G(),[p,o]=r.useState([]),[c,t]=r.useState([]),[h,n]=r.useState(!0),[m,b]=r.useState(null),g=r.useCallback(async()=>{if(i?.role!=="MENTEE"){n(!1);return}try{n(!0),b(null);const[a,l]=await Promise.all([j.get("/goals"),j.get("/requests/sent")]);o(a.data);const d=l.data.filter(k=>k.status==="ACCEPTED");t(d)}catch(a){b("Failed to fetch your data. Please try again later."),console.error(a)}finally{n(!1)}},[i]);r.useEffect(()=>{g()},[g]);const v=a=>{o(l=>[a,...l])},f=a=>{o(l=>l.map(d=>d.id===a.id?a:d))},N=a=>{o(l=>l.filter(d=>d.id!==a)),j.delete(`/goals/${a}`).catch(l=>{console.error("Failed to delete goal on server:",l),g()})};return h?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Loading..."}):i?.role==="MENTOR"?e.jsxs("div",{className:"text-center py-16 px-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:"Viewing Your Mentees' Goals"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"This page is for mentees to set their personal goals. You can view and manage the goals of your mentees from your dashboard."}),e.jsx(F,{to:"/my-sessions",className:"mt-4 inline-block px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Go to My Mentees"})]}):e.jsxs("div",{className:"container mx-auto p-4 md:p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-6",children:"My S.M.A.R.T. Goals"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 dark:text-gray-100",children:"Add a New Goal"}),e.jsx(A,{onGoalCreated:v,mentorships:c})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 dark:text-gray-100",children:"Current Goals"}),m&&e.jsx("p",{className:"text-red-500",children:m}),!m&&e.jsx(E,{goals:p,onUpdate:f,onDelete:N})]})]})]})};export{P as default};
