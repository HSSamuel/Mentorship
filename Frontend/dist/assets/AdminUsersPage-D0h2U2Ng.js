import{r,c as E,j as e}from"./index-D8cSyDI9.js";const D=({isOpen:n,onClose:a,onConfirm:o,title:l,children:d})=>n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:l}),e.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:d}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 rounded bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{onClick:o,className:"px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700",children:"Confirm"})]})]})}):null,L=({isOpen:n,onClose:a,onSave:o,user:l,selectedRole:d,setSelectedRole:x})=>!n||!l?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:["Edit Role for ",l.profile.name]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"role-select",className:"mb-2 font-semibold text-gray-700 dark:text-gray-300",children:"User Role"}),e.jsxs("select",{id:"role-select",value:d,onChange:g=>x(g.target.value),className:"p-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"ADMIN",children:"ADMIN"}),e.jsx("option",{value:"MENTOR",children:"MENTOR"}),e.jsx("option",{value:"MENTEE",children:"MENTEE"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 rounded bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{onClick:o,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Save Changes"})]})]})}),F=()=>{const[n,a]=r.useState([]),[o,l]=r.useState([]),[d,x]=r.useState(!0),[g,u]=r.useState(null),[i,C]=r.useState(""),[M,m]=r.useState(!1),[c,b]=r.useState(null),[S,p]=r.useState(!1),[h,y]=r.useState(null),[f,j]=r.useState("MENTEE"),N=r.useCallback(async()=>{try{x(!0);const s=(await E.get("/admin/users")).data.users||[];a(s),l(s),u(null)}catch(t){t.response?.status===401?u("Unauthorized: Please log in again."):u("Failed to fetch users. Please try again later."),console.error(t)}finally{x(!1)}},[]);r.useEffect(()=>{N()},[N]),r.useEffect(()=>{const t=n.filter(s=>(s.profile?.name?.toLowerCase()||"n/a").includes(i.toLowerCase())||s.email.toLowerCase().includes(i.toLowerCase())||s.role.toLowerCase().includes(i.toLowerCase()));l(t)},[i,n]);const U=t=>{b(t),m(!0)},k=()=>{b(null),m(!1)},T=async()=>{c&&(console.log(`Simulating deletion of user: ${c.id}`),a(t=>t.filter(s=>s.id!==c.id)),k())},R=t=>{y(t),j(t.role),p(!0)},w=()=>{p(!1),y(null)},A=async()=>{if(h)try{const s=(await E.put(`/admin/users/${h.id}/role`,{role:f})).data;a(O=>O.map(v=>v.id===s.id?s:v)),w()}catch(t){u(`Failed to update role for ${h.profile.name}.`),console.error(t)}};return d?e.jsx("div",{className:"text-center p-10",children:"Loading users..."}):g?e.jsx("div",{className:"text-center p-10 text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-300 rounded-md",children:g}):e.jsxs("div",{className:"container mx-auto p-4 md:p-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-white",children:"User Management"}),e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",placeholder:"Search by name, email, or role...",className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",value:i,onChange:t=>C(t.target.value)})}),e.jsx("div",{className:"overflow-x-auto bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700/50 border-b-2 border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 uppercase font-semibold text-sm text-gray-600 dark:text-gray-300",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 uppercase font-semibold text-sm text-gray-600 dark:text-gray-300",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 uppercase font-semibold text-sm text-gray-600 dark:text-gray-300",children:"Role"}),e.jsx("th",{className:"text-center py-3 px-4 uppercase font-semibold text-sm text-gray-600 dark:text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"text-gray-700 dark:text-gray-300",children:o.length>0?o.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("td",{className:"py-3 px-4",children:t.profile?.name||"N/A"}),e.jsx("td",{className:"py-3 px-4",children:t.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.role==="ADMIN"?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200":t.role==="MENTOR"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:t.role})}),e.jsxs("td",{className:"py-3 px-4 text-center",children:[e.jsx("button",{onClick:()=>R(t),className:"text-blue-600 dark:text-blue-400 hover:underline mr-4",children:"Edit"}),e.jsx("button",{onClick:()=>U(t),className:"text-red-600 dark:text-red-400 hover:underline",children:"Delete"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-10",children:"No users found."})})})]})}),e.jsx(D,{isOpen:M,onClose:k,onConfirm:T,title:"Confirm User Deletion",children:e.jsxs("p",{children:["Are you sure you want to delete this user:"," ",e.jsx("strong",{children:c?.profile?.name||c?.email}),"? This action cannot be undone."]})}),e.jsx(L,{isOpen:S,onClose:w,onSave:A,user:h,selectedRole:f,setSelectedRole:j})]})};export{F as default};
